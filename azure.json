{
   "device": {
      "element_reference": "device",
      "specs": {
         "device group id": {
            "type": "String",
            "description": "Azure device group id"
         }
      },
      "api": {
         "add_device": {
            "path": "api/devices/[deviceId]?api-version=2022-07-31",
            "type": "PUT",
            "return": "JSON"
         },
         "get_device": {
            "path": "api/devices/[deviceId]?api-version=2022-07-31",
            "type": "GET",
            "return": "JSON"
         },
         "get_devices": {
            "path": "api/devices?api-version=2022-07-31",
            "type": "GET",
            "return": "JSON"
         }
      }
   },
   "device_template": {
      "api": {
         "add_device_template": {
            "path": "api/deviceTemplates/[deviceTemplateId]?api-version=2022-07-31",
            "type": "PUT",
            "return": "JSON"
         },
         "get_device_template": {
            "path": "api/deviceTemplates/[deviceTemplateId]?api-version=2022-07-31",
            "type": "GET",
            "return": "JSON"
         },
         "get_devices_templates": {
            "path": "api/deviceTemplates?api-version=2022-07-31",
            "type": "GET",
            "return": "JSON"
         }
      }
   },
   "device_group": {
      "api": {
         "add_device_group": {
            "path": "api/deviceGroups/[deviceGroupId]?api-version=2022-07-31",
            "type": "PUT",
            "return": "JSON"
         },
         "get_device_group": {
            "path": "api/deviceGroups/[deviceGroupId]?api-version=2022-07-31",
            "type": "GET",
            "return": "JSON"
         },
         "get_device_groups": {
            "path": "api/deviceGroups?api-version=2022-07-31",
            "type": "GET",
            "return": "JSON"
         }
      }
   },
   "service": {
      "element_reference": "device_profile",
      "specs": {
         "Primary Key": {
            "type": "String",
            "description": "Primary key"
         },
         "Secondary Key": {
            "type": "String",
            "description": "Secondary key"
         }
      },
      "api": {
         "create_device_profile": {
            "path": "api/deviceProfile",
            "type": "POST",
            "return": "JSON"
         },
         "get_device_profile": {
            "path": "api/deviceProfile/[deviceProfileId]",
            "type": "GET",
            "return": "JSON"
         },
         "get_default_device_profile": {
            "path": "api/deviceProfileInfo/default",
            "type": "GET",
            "return": "JSON"
         }
      }
   },
   "attribute": [
      {
         "Humidity": {
            "specs": {}
         },
         "Temperature": {
            "specs": {
               "Unit": {
                  "type": "String",
                  "description": "kelvin, degreeCelsius or degreeFahrenheit"
               }
            }
         },
         "Distance": {
            "specs": {
               "Maximum": {
                  "type": "Double",
                  "description": "meters detectable"
               }
            }
         },
         "Acceleration": {
            "specs": {
               "Maximum": {
                  "type": "Double",
                  "description": "m/second squared detectable"
               }
            }
         },
         "Pressure": {
            "specs": {
               "Unit": {
                  "type": "String",
                  "description": "bar / millibar / pascal / kilopascal"
               }
            }
         },
         "Area": {
            "specs": {
               "Unit": {
                  "type": "String",
                  "description": "squareMetre / squareCentimetre / squareMillimetre / squareKilometer / acre / hectare"
               }
            }
         },
         "Mass": {
            "specs": {
               "Unit": {
                  "type": "String",
                  "description": "kilogram / gram / milligram /microgram"
               }
            }
         },
         "Force": {
            "specs": {
               "Unit": {
                  "type": "String",
                  "description": "newton / pound / ounce / ton"
               }
            }
         }
      }
   ],
   "system": {
      "element_reference": "asset",
      "api": {
         "get_asset_types": {
            "path": "api/asset/types",
            "type": "GET",
            "return": "JSON"
         },
         "get_assets_of_type": {
            "path": "api/tenant/assets?type=[objectType]&pageSize=9999&page=0",
            "type": "GET",
            "return": "JSON"
         },
         "get_asset": {
            "path": "api/asset/[assetId]",
            "type": "GET",
            "return": "JSON"
         },
         "create_asset": {
            "path": "api/asset",
            "type": "POST",
            "return": "JSON"
         }
      }
   },
   "dashboard": {
      "element_reference": "asset",
      "api": {
         "get_dashboard": {
            "path": "api/dashboards/[dashboardId]?api-version=2022-10-31-preview",
            "type": "GET",
            "return": "JSON"
         },
         "get_dashboards": {
            "path": "api/dashboards?api-version=2022-10-31-preview",
            "type": "GET",
            "return": "JSON"
         },
         "add_dashboard": {
            "path": " api/dashboards/[dashboardId]?api-version=2022-10-31-preview",
            "type": "PUT",
            "return": "JSON"
         }
      }
   },
   "widget": [
      {
         "Last Known Value (lkv)": {
            "config": {
               "displayName": "Root System Dashboard",
               "tiles": [
                  {
                     "displayName": "Device - Widget (Last Known Value)",
                     "configuration": {
                        "type": "lkv",
                        "capabilities": [
                           {
                              "capability": "EnlightmentFunctionality",
                              "aggregateFunction": "avg"
                           }
                        ],
                        "group": "b514a79f-1c9d-4647-9adf-d8953ca4f91a",
                        "devices": [
                           "2cjxx3vw5wy"
                        ],
                        "format": {
                           "textSize": 14
                        },
                        "queryRange": {
                           "type": "time",
                           "duration": "PT30M",
                           "resolution": "PT1M"
                        }
                     },
                     "x": 0,
                     "y": 0,
                     "width": 2,
                     "height": 2
                  },
                  {
                     "displayName": "Documentation",
                     "configuration": {
                        "type": "markdown",
                        "description": "Comprehensive help articles and links to more support.",
                        "href": "https://aka.ms/iotcentral-pnp-docs",
                        "image": "4d6c6373-0220-4191-be2e-d58ca2a289e1",
                        "queryRange": {
                           "type": "time",
                           "duration": "PT30M",
                           "resolution": "PT1M"
                        }
                     },
                     "x": 2,
                     "y": 0,
                     "width": 1,
                     "height": 1
                  }
               ]
            }
         },
         "Line Chart": {
            "config": {
               "displayName": "Root System Dashboard",
               "tiles": [
                  {
                     "displayName": "Device - Widget (Line chart)",
                     "configuration": {
                        "type": "lineChart",
                        "capabilities": [
                           {
                              "capability": "EnlightmentFunctionality",
                              "aggregateFunction": "avg"
                           }
                        ],
                        "group": "b514a79f-1c9d-4647-9adf-d8953ca4f91a",
                        "devices": [
                           "2cjxx3vw5wy"
                        ],
                        "format": {
                           "textSize": 14
                        },
                        "queryRange": {
                           "type": "time",
                           "duration": "PT30M",
                           "resolution": "PT1M"
                        }
                     },
                     "x": 0,
                     "y": 0,
                     "width": 2,
                     "height": 2
                  },
                  {
                     "displayName": "Documentation",
                     "configuration": {
                        "type": "markdown",
                        "description": "Comprehensive help articles and links to more support.",
                        "href": "https://aka.ms/iotcentral-pnp-docs",
                        "image": "4d6c6373-0220-4191-be2e-d58ca2a289e1"
                     },
                     "x": 2,
                     "y": 0,
                     "width": 1,
                     "height": 1
                  }
               ]
            }
         }
      }
   ],
   "request_out": [
      {
         "GET": {
            "specs": {
               "endpoint": {
                  "type": "String",
                  "description": "Destination url"
               },
               "header_Key": {
                  "type": "String",
                  "description": "Key"
               },
               "header_Value": {
                  "type": "String",
                  "description": "Value"
               },
               "body": {
                  "type": "String",
                  "description": "Body"
               }
            },
            "config": {
               "HTTP": {
                  "inputs": {
                     "body": "body",
                     "headers": {
                        "Key": "Value"
                     },
                     "method": "GET",
                     "uri": "https://genzingapplication.azureiotcentral.com/mioURI"
                  },
                  "runAfter": {
                     "When_a_rule_is_fired": [
                        "Succeeded"
                     ]
                  },
                  "type": "Http"
               }
            }
         },
         "PUT": {
            "specs": {
               "endpoint": {
                  "type": "String",
                  "description": "Destination url"
               },
               "header_Key": {
                  "type": "String",
                  "description": "Key"
               },
               "header_Value": {
                  "type": "String",
                  "description": "Value"
               },
               "body": {
                  "type": "String",
                  "description": "Body"
               }
            },
            "config": {
               "HTTP": {
                  "inputs": {
                     "body": "body",
                     "headers": {
                        "Key": "Value"
                     },
                     "method": "PUT",
                     "uri": "https://genzingapplication.azureiotcentral.com/mioURI"
                  },
                  "runAfter": {
                     "When_a_rule_is_fired": [
                        "Succeeded"
                     ]
                  },
                  "type": "Http"
               }
            }
         },
         "DELETE": {
            "specs": {
               "endpoint": {
                  "type": "String",
                  "description": "Destination url"
               },
               "header_Key": {
                  "type": "String",
                  "description": "Key"
               },
               "header_Value": {
                  "type": "String",
                  "description": "Value"
               },
               "body": {
                  "type": "String",
                  "description": "Body"
               }
            },
            "config": {
               "HTTP": {
                  "inputs": {
                     "body": "body",
                     "headers": {
                        "Key": "Value"
                     },
                     "method": "DELETE",
                     "uri": "https://genzingapplication.azureiotcentral.com/mioURI"
                  },
                  "runAfter": {
                     "When_a_rule_is_fired": [
                        "Succeeded"
                     ]
                  },
                  "type": "Http"
               }
            }
         },
         "PATCH": {
            "specs": {
               "endpoint": {
                  "type": "String",
                  "description": "Destination url"
               },
               "header_Key": {
                  "type": "String",
                  "description": "Key"
               },
               "header_Value": {
                  "type": "String",
                  "description": "Value"
               },
               "body": {
                  "type": "String",
                  "description": "Body"
               }
            },
            "config": {
               "HTTP": {
                  "inputs": {
                     "body": "body",
                     "headers": {
                        "Key": "Value"
                     },
                     "method": "PATCH",
                     "uri": "https://genzingapplication.azureiotcentral.com/mioURI"
                  },
                  "runAfter": {
                     "When_a_rule_is_fired": [
                        "Succeeded"
                     ]
                  },
                  "type": "Http"
               }
            }
         },
         "POST": {
            "specs": {
               "endpoint": {
                  "type": "String",
                  "description": "Destination url"
               },
               "header_Key": {
                  "type": "String",
                  "description": "Key"
               },
               "header_Value": {
                  "type": "String",
                  "description": "Value"
               },
               "body": {
                  "type": "String",
                  "description": "Body"
               }
            },
            "config": {
               "HTTP": {
                  "inputs": {
                     "body": "body",
                     "headers": {
                        "Key": "Value"
                     },
                     "method": "POST",
                     "uri": "https://genzingapplication.azureiotcentral.com/mioURI"
                  },
                  "runAfter": {
                     "When_a_rule_is_fired": [
                        "Succeeded"
                     ]
                  },
                  "type": "Http"
               }
            }
         }
      }
   ],
   "pubsub_out": [
      {
         "Send message": {
            "specs": {
               "Connection name": {
                  "type": "String",
                  "description": "Api endpoint url"
               },
               "Authentication type": {
                  "type": "String",
                  "description": "Access Key"
               },
               "Connection string": {
                  "type": "String",
                  "description": "Azure Service Bus Connection String"
               }
            },
            "config": {
               "Send_message": {
                  "inputs": {
                     "host": {
                        "connection": {
                           "name": "@parameters('$connections')['undefined']['connectionId']"
                        }
                     },
                     "method": "post",
                     "path": "/@{encodeURIComponent(encodeURIComponent(''))}/messages",
                     "queries": {
                        "systemProperties": "None"
                     }
                  },
                  "runAfter": {
                     "When_a_rule_is_fired": [
                        "Succeeded"
                     ]
                  },
                  "type": "ApiConnection"
               }
            },
            "output": [
               "Success"
            ]
         }
      }
   ],
   "storage": [
      {
         "Create_or_update_a_device": {
            "specs": {
               "Device id": {
                  "type": "String",
                  "description": "Unique ID of the device"
               },
               "Display name": {
                  "type": "String",
                  "description": "Name should be same as the ID"
               }
            },
            "config": {
               "Create_or_update_a_device": {
                  "inputs": {
                     "body": {
                        "displayName": "Name should be same as the ID"
                     },
                     "host": {
                        "connection": {
                           "name": "@parameters('$connections')['azureiotcentral']['connectionId']"
                        }
                     },
                     "method": "put",
                     "path": "/api/ga_2022_07_31/devices/@{encodeURIComponent('Unique ID of the device')}",
                     "queries": {
                        "application": "Azure iot central application id"
                     }
                  },
                  "runAfter": {},
                  "type": "ApiConnection"
               }
            }
         },
         "Insert_Document": {
            "specs": {
               "Collection name": {
                  "type": "String",
                  "Collection name": "collection name"
               },
               "Data source": {
                  "type": "String",
                  "description": "cluster name"
               },
               "Database": {
                  "type": "String",
                  "description": "DB name"
               },
               "Document": {
                  "type": "String",
                  "description": "ejson file"
               }
            },
            "config": {
               "Insert_Document": {
                  "inputs": {
                     "body": {
                        "collection": "collection name",
                        "dataSource": "cluster name",
                        "database": "db name",
                        "document": "ejson file"
                     },
                     "headers": {
                        "Access-Control-Request-Headers": "*",
                        "Content-Type": "application/json"
                     },
                     "host": {
                        "connection": {
                           "name": "@parameters('$connections')['mongodb']['connectionId']"
                        }
                     },
                     "method": "post",
                     "path": "/action/insertOne"
                  },
                  "runAfter": {},
                  "type": "ApiConnection"
               }
            }
         }
      }
   ],
   "datastream_out": [
      {
         "http": {
            "specs": {
               "endpoint": {
                  "type": "String",
                  "description": "Api endpoint url"
               },
               "method": {
                  "type": "String",
                  "description": "Request method"
               }
            },
            "config": {
               "Run_a_device_command": {
                  "inputs": {
                     "host": {
                        "connection": {
                           "name": "@parameters('$connections')['azureiotcentral']['connectionId']"
                        }
                     },
                     "method": "post",
                     "path": "/api/v1/devices/@{encodeURIComponent('device id')}/commands/@{encodeURIComponent('dev command')}",
                     "queries": {
                        "application": "app id"
                     }
                  },
                  "runAfter": {},
                  "type": "ApiConnection"
               }
            }
         }
      }
   ],
   "Logic_app_JSON_template": {
      "json_structure": {
         "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
         "contentVersion": "1.0.0.0",
         "parameters": {
            "workflows_LogicApplicationNameee_name": {
               "defaultValue": "maZioskyDai",
               "type": "String"
            },
            "connections_azureiotcentral_externalid": {
               "defaultValue": "/subscriptions/24a9446b-8b9b-42af-85ab-6476a6ad7cfc/resourceGroups/GenzingResourceGroup/providers/Microsoft.Web/connections/azureiotcentral",
               "type": "String"
            }
         },
         "variables": {},
         "resources": [
            {
               "type": "Microsoft.Logic/workflows",
               "apiVersion": "2017-07-01",
               "name": "[parameters('workflows_LogicApplicationNameee_name')]",
               "location": "francesouth",
               "tags": {
                  "ms-resource-usage": "azure-cloud-shell"
               },
               "properties": {
                  "state": "Enabled",
                  "definition": {
                     "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                     "contentVersion": "1.0.0.0",
                     "parameters": {
                        "$connections": {
                           "defaultValue": {},
                           "type": "Object"
                        }
                     },
                     "triggers": {
                        "Quando_una_regola_viene_generata": {
                           "type": "ApiConnectionWebhook",
                           "inputs": {
                              "body": {
                                 "rule": "d3dea85d-c411-4b1d-8772-02fc2b17f12b",
                                 "url": "@{listCallbackUrl()}"
                              },
                              "host": {
                                 "connection": {
                                    "name": "@parameters('$connections')['azureiotcentral']['connectionId']"
                                 }
                              },
                              "path": "/api/preview/_internal/workflow/triggers",
                              "queries": {
                                 "application": "91d7a589-aeee-49f2-a0bb-3abdf92825ac"
                              }
                           }
                        }
                     },
                     "actions": {
                        "Aggiorna_proprietà_dispositivo": {
                           "runAfter": {},
                           "type": "ApiConnection",
                           "inputs": {
                              "body": {
                                 "CloudPropertyPrimoDev": 34
                              },
                              "host": {
                                 "connection": {
                                    "name": "@parameters('$connections')['azureiotcentral']['connectionId']"
                                 }
                              },
                              "method": "patch",
                              "path": "/api/v1/devices/@{encodeURIComponent(parameters('PrimoDevice'))}/properties",
                              "queries": {
                                 "application": "91d7a589-aeee-49f2-a0bb-3abdf92825ac",
                                 "template": "dtmi:ynkz72wor:fplbzpsksh"
                              }
                           }
                        }
                     },
                     "outputs": {}
                  },
                  "parameters": {
                     "$connections": {
                        "value": {
                           "azureiotcentral": {
                              "connectionId": "[parameters('connections_azureiotcentral_externalid')]",
                              "connectionName": "azureiotcentral",
                              "id": "/subscriptions/24a9446b-8b9b-42af-85ab-6476a6ad7cfc/providers/Microsoft.Web/locations/francesouth/managedApis/azureiotcentral"
                           }
                        }
                     }
                  }
               }
            }
         ]
      }
   }
}